# 📋 文件整理计划

> **任务名称**: {任务名称}  
> **目标目录**: {目标目录路径}  
> **计划制定时间**: {制定日期时间}  
> **预计执行时间**: {预估执行时长}  
> **风险等级**: {低/中/高}

---

## 🎯 整理目标

### 主要目标
- [ ] {目标1 - 具体可衡量的目标}
- [ ] {目标2 - 具体可衡量的目标}
- [ ] {目标3 - 具体可衡量的目标}

### 成功标准
- **结构清晰**: {具体标准描述}
- **命名规范**: {命名规则}
- **分类明确**: {分类标准}
- **易于维护**: {维护标准}

### 🏷️ 主题文件夹处理策略
- **识别的主题文件夹**: {列出识别到的主题文件夹}
  - `{文件夹名1}` - {文件数}个文件 - **类型**: {人名/地名/事件/项目} - **关联度**: {高/中/低}
  - `{文件夹名2}` - {文件数}个文件 - **类型**: {人名/地名/事件/项目} - **关联度**: {高/中/低}
- **处理方案**: 
  - **默认策略**: 整体移动到99_待确认\主题文件夹目录
  - **保护原则**: 保持文件夹结构完整性，避免破坏文件关联
  - **标记方式**: 在文件夹名前添加[主题]标记便于识别
- **特殊处理**:
  - **高关联度**: 必须保持完整，不允许拆解
  - **中关联度**: 可以考虑部分拆解，但需用户确认
  - **低关联度**: 可以按标准分类，但建议征求用户意见
- **后续处理**: 等待用户确认是否拆解或重新分类
- **决策依据**:
  - 文件创建时间的集中度
  - 文件命名的一致性
  - 文件内容的相关性
  - 用户的使用习惯

---

## 🏗️ 目标结构设计

### 新目录结构选择
请根据您的使用场景选择合适的目录模板：

> **📋 详细模板请参考**: [directory-templates.md](directory-templates.md)

- **🎓 学术研究型**: 适合教师、研究人员、学生等学术工作者
- **💼 商务办公型**: 适合企业员工、管理人员、商务人士等
- **🏠 个人生活型**: 适合个人用户、家庭使用、生活管理等

### 目标结构示例
```
{目标目录名}/
├── 01_[选择的主分类1]/
│   ├── [子分类1]/
│   ├── [子分类2]/
│   └── [子分类3]/
├── 02_[选择的主分类2]/
│   ├── [子分类1]/
│   └── [子分类2]/
├── 03_[选择的主分类3]/
├── ...
└── 99_待整理/
    ├── 新文件暂存/
    ├── 主题文件夹/
    └── 需确认分类/
```

### 模板自定义说明
- **编号前缀**: 使用01-99编号确保目录排序稳定
- **命名规范**: 使用有意义的中文目录名，便于理解
- **层级控制**: 建议不超过4层目录深度
- **灵活调整**: 可根据实际需要调整子目录名称和结构

### 分类规则
根据选择的目录模板，制定相应的分类规则：

| 分类原则 | 说明 | 示例 |
|---------|------|------|
| **文件类型分类** | 按文件扩展名和用途分类 | 文档类(.docx, .pdf), 媒体类(.jpg, .mp4) |
| **项目关联分类** | 按项目或主题组织 | 项目A资料, 课程B材料 |
| **时间序列分类** | 按创建时间或使用时间 | 2024年文档, 当前项目 |
| **重要性分类** | 按使用频率和重要性 | 常用文档, 归档文件 |

### 命名规范
| 命名类型 | 建议格式 | 示例 |
|---------|----------|------|
| **日常文档** | 日期_项目_描述 | 20241224_年会_策划方案.docx |
| **学术文献** | 作者_年份_标题 | 张三_2024_人工智能研究.pdf |
| **项目文件** | 项目名_阶段_内容 | 网站改版_需求_用户调研.xlsx |
| **媒体文件** | 日期_事件_描述 | 20241224_年会_开场视频.mp4 |

---

## 📝 执行步骤

### 阶段1：准备工作 (预计30分钟)
1. **创建备份**
   - [ ] 创建整个目录的备份副本
   - [ ] 验证备份完整性
   - [ ] 记录备份位置和时间
   - [ ] 运行重复文件检测脚本

2. **创建新目录结构**
   - [ ] 按设计创建所有一级目录
   - [ ] 创建必要的二级目录
   - [ ] 设置目录权限（如需要）
   - [ ] 执行自动化目录创建脚本

3. **重复文件分析**
   - [ ] 运行Python重复文件检测工具
   - [ ] 分析重复文件报告
   - [ ] 制定重复文件处理策略
   - [ ] 标记需要保留的版本

### 阶段2：批量移动 (预计2小时)
1. **文档类文件移动**
   - [ ] 识别并移动office文档 (.docx, .xlsx, .pptx)
   - [ ] 识别并移动PDF文件
   - [ ] 按内容类型进一步分类

2. **媒体文件移动**
   - [ ] 移动图片文件 (.jpg, .png, .gif等)
   - [ ] 移动视频文件 (.mp4, .avi, .mov等)
   - [ ] 移动音频文件 (.mp3, .wav等)

3. **软件工具移动**
   - [ ] 移动安装包文件 (.exe, .msi等)
   - [ ] 移动压缩包 (.zip, .rar等)
   - [ ] 移动便携软件

### 阶段3：精细整理 (预计1.5小时)
1. **文件重命名**
   - [ ] 规范化文档文件名
   - [ ] 统一日期格式
   - [ ] 清理特殊字符

2. **重复文件处理**
   - [ ] 识别重复文件
   - [ ] 保留最新版本
   - [ ] 删除冗余副本

3. **空目录清理**
   - [ ] 删除空目录
   - [ ] 合并功能相似目录
   - [ ] 调整目录结构

### 阶段4：验证与检查 (预计30分钟)
1. **完整性验证**
   - [ ] **原目录清空检查**: 扫描原目录确保完全清空（包括所有子目录）
     ```powershell
     # 检查脚本
     Get-ChildItem "原目录" -Recurse | Where-Object { $_.FullName -notlike "*已整理*" }
     ```
   - [ ] **文件数量验证**: 验证每个分类目录的文件数量正确
     ```powershell
     # 对比脚本
     $before = (Get-ChildItem "备份目录" -Recurse -File).Count
     $after = (Get-ChildItem "整理后目录" -Recurse -File).Count
     ```
   - [ ] **文件完整性检查**: 检查文件完整性（大小、修改时间等）
   - [ ] **主题文件夹处理确认**: 确认主题文件夹已正确处理到99_待确认目录
   - [ ] **重复文件处理验证**: 确认重复文件按规则正确处理

2. **质量检查**
   - [ ] **分类准确性验证**: 验证文件分类准确性
     - 检查文档类文件是否在文档目录
     - 检查媒体文件是否在媒体目录
     - 检查软件工具是否在工具目录
   - [ ] **命名规范执行情况**: 检查命名规范执行情况
     - 文件名是否符合规范
     - 目录名是否符合标准
     - 特殊字符是否已清理
   - [ ] **重复文件处理结果**: 确认重复文件处理结果
     - 同目录重复是否已去除
     - 跨目录重复是否按规则保留
     - 处理日志是否完整
   - [ ] **可用性测试**: 测试目录结构易用性
     - 查找常用文件是否便捷
     - 目录层级是否合理
     - 分类逻辑是否清晰

3. **自动化验证脚本**
```powershell
# 综合验证脚本
function Test-OrganizationResult {
    param(
        [string]$OriginalPath,
        [string]$OrganizedPath,
        [string]$BackupPath
    )
    
    Write-Host "=== 开始验证检查 ===" -ForegroundColor Cyan
    
    # 1. 文件数量检查
    $originalCount = (Get-ChildItem $BackupPath -Recurse -File).Count
    $organizedCount = (Get-ChildItem $OrganizedPath -Recurse -File).Count
    
    if ($originalCount -eq $organizedCount) {
        Write-Host "✅ 文件数量一致: $originalCount" -ForegroundColor Green
    } else {
        Write-Host "❌ 文件数量不一致: 原始$originalCount vs 整理后$organizedCount" -ForegroundColor Red
    }
    
    # 2. 原目录清空检查
    $remaining = Get-ChildItem $OriginalPath -Recurse -Force
    if ($remaining.Count -eq 0) {
        Write-Host "✅ 原目录已完全清空" -ForegroundColor Green
    } else {
        Write-Host "❌ 原目录仍有 $($remaining.Count) 个项目" -ForegroundColor Red
    }
    
    # 3. 运行重复文件检测
    Write-Host "🔍 检查重复文件..." -ForegroundColor Yellow
    python "tools\duplicate_detector.py" --directory $OrganizedPath --output "final_check.json"
    
    Write-Host "=== 验证完成 ===" -ForegroundColor Cyan
}
```

### 阶段5：复盘与改进 (预计20分钟)
1. **问题识别与分析**
   - [ ] **整理过程问题记录**
     - 记录遇到的困难和障碍
     - 识别工具或流程的不足
     - 统计错误操作和返工次数
   - [ ] **验证发现的问题**
     - 文件遗漏或错误分类
     - 主题文件夹处理不当
     - 重复文件处理错误
   - [ ] **根本原因分析**
     - 使用5W1H分析法
     - 区分工具问题、流程问题、人为问题
     - 评估问题对整理效果的影响程度

2. **改进建议制定**
   - [ ] **短期改进措施**（立即可执行）
     - 修正当前任务中的问题
     - 更新操作清单
     - 补充遗漏的验证步骤
   - [ ] **中期改进计划**（下次任务改进）
     - 优化工作流程
     - 改进工具功能
     - 完善模板内容
   - [ ] **长期改进策略**（系统性改进）
     - 建立质量控制机制
     - 开发自动化工具
     - 制定培训和推广计划

3. **复盘记录模板**
```markdown
## 复盘记录 - {任务名称}

### 基本信息
- 完成时间: {日期时间}
- 处理文件数: {数量}
- 总耗时: {时间}
- 参与人员: {人员}

### 成果总结
✅ **成功方面**:
- {成功点1 - 具体描述}
- {成功点2 - 具体描述}

❌ **问题方面**:
- {问题1 - 描述 - 影响 - 原因}
- {问题2 - 描述 - 影响 - 原因}

### 改进措施
🔧 **立即执行**:
- [ ] {措施1 - 负责人 - 完成时间}
- [ ] {措施2 - 负责人 - 完成时间}

📅 **计划执行**:
- [ ] {措施1 - 计划时间}
- [ ] {措施2 - 计划时间}

### 经验教训
💡 **经验总结**:
- {经验1}
- {经验2}

⚠️ **注意事项**:
- {注意事项1}
- {注意事项2}
```

4. **持续改进机制**
   - [ ] **定期回顾**: 每月回顾整理任务的复盘记录
   - [ ] **经验分享**: 在团队内分享成功经验和失败教训
   - [ ] **文档更新**: 及时更新工作流模板和操作指南
   - [ ] **工具改进**: 根据实际需求持续改进工具功能

---

## ⚠️ 风险评估与预防

### 高风险操作
| 操作类型 | 风险描述 | 预防措施 | 应急方案 |
|---------|----------|----------|----------|
| 批量移动 | 文件丢失或损坏 | 先备份，小批次操作 | 从备份恢复 |
| 重命名 | 文件名错误 | 记录原文件名 | 批量撤销重命名 |
| 删除操作 | 误删重要文件 | 移动到回收站 | 从回收站恢复 |

### 预防措施
- ✅ 执行前完整备份
- ✅ 分阶段执行，每阶段验证
- ✅ 使用PowerShell -WhatIf预览操作
- ✅ 保留详细操作日志
- ✅ 准备回滚脚本
- ✅ 运行重复文件检测，避免重复处理
- ✅ 使用自动化脚本减少手动错误

---

## 🔧 执行命令参考

### 自动化批量操作脚本
```powershell
# 批量目录创建脚本
function Create-OrganizedStructure {
    param([string]$BasePath)
    
    $structure = @{
        "01_工作文档" = @("教学资料", "科研项目", "行政事务", "会议记录")
        "02_学术资源" = @("论文文献", "学术会议", "研究资料")
        "03_课程资料" = @("按学期分类", "按课程分类", "教学资源")
        "04_个人文档" = @("简历履历", "证书证明", "个人笔记")
        "05_媒体文件" = @("图片素材", "视频资料", "音频文件")
        "06_软件工具" = @("安装包", "绿色软件", "插件扩展")
        "07_备份归档" = @("按年份归档", "系统备份", "重要文件备份")
        "08_待整理" = @("新文件暂存", "下载文件", "临时文件")
    }
    
    foreach ($mainDir in $structure.Keys) {
        $mainPath = Join-Path $BasePath $mainDir
        New-Item -ItemType Directory -Path $mainPath -Force
        
        foreach ($subDir in $structure[$mainDir]) {
            $subPath = Join-Path $mainPath $subDir
            New-Item -ItemType Directory -Path $subPath -Force
        }
    }
    Write-Host "目录结构创建完成！"
}

# 批量文件移动脚本
function Move-FilesByType {
    param(
        [string]$SourcePath,
        [string]$TargetPath,
        [string[]]$Extensions,
        [switch]$WhatIf
    )
    
    $files = Get-ChildItem $SourcePath -Recurse -File | 
             Where-Object { $_.Extension -in $Extensions }
    
    foreach ($file in $files) {
        $destination = Join-Path $TargetPath $file.Name
        if ($WhatIf) {
            Write-Host "将移动: $($file.FullName) -> $destination"
        } else {
            Move-Item $file.FullName $destination -Force
        }
    }
}

# 批量重命名脚本
function Rename-FilesWithPattern {
    param(
        [string]$Path,
        [string]$Pattern,
        [string]$Replacement,
        [switch]$WhatIf
    )
    
    Get-ChildItem $Path -File | Where-Object { $_.Name -match $Pattern } | 
    ForEach-Object {
        $newName = $_.Name -replace $Pattern, $Replacement
        if ($WhatIf) {
            Write-Host "将重命名: $($_.Name) -> $newName"
        } else {
            Rename-Item $_.FullName $newName
        }
    }
}
```

### PowerShell命令集
```powershell
# 1. 创建目录结构
Create-OrganizedStructure -BasePath "目标路径"

# 2. 按类型移动文件（预览模式）
Move-FilesByType -SourcePath "源路径" -TargetPath "目标路径\01_工作文档" -Extensions @(".docx",".pdf",".xlsx") -WhatIf

# 3. 批量重命名（移除空格）
Rename-FilesWithPattern -Path "目标路径" -Pattern " " -Replacement "_" -WhatIf

# 4. 运行重复文件检测
python "重复文件检测工具.py" --directory "目标路径" --output "重复文件报告.json"
```

### 批处理脚本
```batch
@echo off
echo 开始文件整理操作...
echo 创建备份目录...
xcopy "%TARGET_DIR%" "%BACKUP_DIR%" /s /e /i
echo 备份完成，开始整理...
```

---

## 📊 进度跟踪

### 执行进度
- [ ] 阶段1：准备工作 (0/4步完成)
- [ ] 阶段2：批量移动 (0/3步完成)
- [ ] 阶段3：精细整理 (0/3步完成)
- [ ] 阶段4：验证优化 (0/2步完成)

### 完成统计
- **处理文件数**: 0 / {总文件数}
- **移动文件数**: 0
- **重命名文件数**: 0
- **删除文件数**: 0

---

## 📝 执行日志

### 执行记录
```
[时间] 操作类型 - 详细描述 - 结果状态
[{时间}] 开始 - 创建备份 - 进行中
[{时间}] 完成 - 备份完成 - 成功
```

### 问题记录
| 时间 | 问题描述 | 解决方案 | 状态 |
|------|----------|----------|------|
| {时间} | {问题} | {解决方案} | {状态} |

---

## ✅ 完成检查清单

### 基本要求
- [ ] 所有文件都有明确归类
- [ ] 目录结构清晰合理
- [ ] 文件命名规范统一
- [ ] 没有重复文件
- [ ] 没有空目录

### 高级要求
- [ ] 创建了目录说明文档
- [ ] 建立了文件维护规范
- [ ] 设置了定期整理提醒
- [ ] 完善了使用指南

---

## 🔄 后续维护

### 日常维护规则
1. **新文件处理**: 及时放入对应目录或"待整理"文件夹
2. **定期整理**: 每月整理"待整理"文件夹
3. **归档操作**: 季度将完成项目移入"备份归档"
4. **清理检查**: 半年检查并清理过期文件

### 维护计划
- **每周**: 检查"待整理"文件夹
- **每月**: 整理新增文件
- **每季度**: 归档完成项目
- **每年**: 全面检查优化结构
